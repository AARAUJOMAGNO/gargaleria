<%= render 'shared/navbar_intern' %>
<div style="display:flex; flex-direction: column; margin: 30px;">

  <div class="dashboard-title" style="display: flex; flex-direction: row; justify-content: space-between; align-items: center; margin-bottom: 30px; margin-right:30px;">
    <div>
        <h1>View dashboard</h1>
    </div>
    <div style="display: flex; justify-content: center; align-items: center">
    <% if current_user.seller %>
    <div style="margin-right: 20px;">
      <%= link_to 'Return', beverages_path %>
    </div>
    <div>
      <%= link_to 'Create', new_dashboard_beverage_path, class:"btn btn-warning" %>
    </div>
    <% end %>
  </div>
  </div>

  <div class="dashboard-content" style="display: flex; flex-direction: row; height: 100vh;">

    <div class="dashboard-content-cards" style="width: 70vw; display: flex; flex-direction: column; justify-content: flex-start; margin-right:30px;">
    <% if current_user.seller %>
      <% @beverages.each do |beverage| %>
        <% if beverage.published %>
          <div style="margin-bottom:10px; display: flex; flex-direction: row; justify-content: space-between; align-items: center; border-bottom: 2px solid grey; padding: 10px;">
            <div>
              <% if beverage.photo.url %>
                <%= cl_image_tag beverage.photo, height: 150, width: 200, crop: :fill %>
              <% end %>
              </div>
              <div style="display: flex; flex-direction: column; flex-grow: 1; margin-left: 20px;">
                <div>
                <%= link_to beverage.name, dashboard_beverage_path(beverage) %>
                </div>
                <div>
                <%= beverage.description %>
                </div>
                <div>
                <%= beverage.price %>
                </div>
                <div>
                <%= beverage.stock %>
                </div>
            </div>
            <div>
            <%= link_to 'delete', dashboard_beverage_path(beverage), method: :delete, data: {confirm:'are you sure?'}, class:"btn btn-danger" %>
            </div>
          </div>
          <% end %>
        <% end %>
      <% end %>
      <div style="display: flex; justify-content: center;">
        <%= paginate @beverages %>
      </div>
    </div>

  <div class="dashboard-content-report" style="width: 30vw; display: flex;  flex-direction: column; justify-content: flex-start; margin-right: 30px;">
    <div style = "margin-bottom: 100px;">
      <div style="text-align: center; background: grey;">
        <h3>Purchase history</h3>
      </div>
      <div>
        <% @orders_buy.each do |buy| %>
        <%= link_to buy.beverage.name, dashboard_order_path(buy.id)%>
          Status: <%= buy.status %>
          <%= buy.created_at.strftime("%d/%m/%Y") %>
        <% end %>
      </div>
    </div>
    <% if current_user.seller %>
    <div style = "display: flex; flex-direction: column; justify-content: center;">
      <div style="text-align: center; background: grey; margin-bottom: 20px;">
        <h3>Sales history</h3>
      </div>
      <div style="display: flex; flex-direction: column;">
        <% @orders_sell.each do |sell| %>
          <% sell.each do |item|  %>
            <ul style="list-style-type: none;">
              <li>
            <%= link_to item.beverage.name, dashboard_order_path(item.id)%>
            <%= item.status%>
            <%= item.created_at.strftime("%d/%m/%Y") %>
              </li>
            </ul>
          <% end  %>
        <% end  %>
      </div>

    </div>
  <% end %>
  </div>

  </div>
</div>
